import java.util.Random;
import java.util.Scanner;

public class Bluejack {
    private static Random random = new Random();
    private static Scanner sc = new Scanner(System.in);

    public static void main(String[] args) {
        while (true) {
            System.out.println("Feeling lucky? Write 'start' to start the game: ");
            String x = sc.next();

            if (x.equalsIgnoreCase("start")) {
                basla();
                break;
            }
        }
    }

    private static String[] olustur() {
        String[] renk1 = {"Red", "Blue", "Green", "Yellow"};
        int[] sayi1 = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};

        String[] deste1 = new String[5];

        for (int i = 0; i < 5; i++) {
            String randomRenk = renk1[new Random().nextInt(renk1.length)];
            int randomSayi = sayi1[new Random().nextInt(sayi1.length)];
            deste1[i] = randomRenk + " " + randomSayi;
        }

        String[] renk2 = {"Red", "Blue", "Green", "Yellow"};
        int[] sayi2 = {+1, +2, +3, +4, +5, +6, -1, -2, -3, -4, -5, -6};

        String[] deste2 = new String[3];

        for (int i = 0; i < 3; i++) {
            String randomRenk2 = renk2[new Random().nextInt(renk2.length)];
            int randomSayi2 = sayi2[new Random().nextInt(sayi2.length)];
            deste2[i] = randomRenk2 + " " + randomSayi2;
        }

        String[] birlesik = new String[deste1.length + deste2.length];

        System.arraycopy(deste1, 0, birlesik, 0, deste1.length);
        System.arraycopy(deste2, 0, birlesik, deste1.length, deste2.length);

        String[] deste3 = new String[2];

        for (int z = 0; z < 2; z++) {

            int olasilik = random.nextInt(100);
            if (olasilik < 21) {
                int t = random.nextInt(2);
                if (t == 1) {
                    deste3[z] = "+/-";
                } else {
                    deste3[z] = "x2";
                }
            } else {
                String[] beklerenk = {"Red", "Blue", "Green", "Yellow"};
                int[] beklesayi = {-6, -5, -4, -3, -2, -1, 1, 2, 3, 4, 5, 6};
                String randombeklerenk = beklerenk[new Random().nextInt(beklerenk.length)];
                int randombeklesayi = beklesayi[new Random().nextInt(beklesayi.length)];
                deste3[z] = randombeklerenk + " " + randombeklesayi;
            }
        }

        String[] deste = new String[deste3.length + birlesik.length];
        System.arraycopy(deste3, 0, deste, 0, deste3.length);
        System.arraycopy(birlesik, 0, deste, deste3.length, birlesik.length);
        return deste;
    }

    private static void PrintHand(String[] hand) {
        for (int i = 0; i < 4; i++) {
            String randomKart = hand[new Random().nextInt(hand.length)];
            System.out.println(randomKart);
        }
    }

    public static void basla() {
        String[] renk = {"Red", "Blue", "Green", "Yellow"};
        int[] sayi = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};

        String[] PlayerHand = olustur();
        String[] CompHand = olustur();

        while (true) {
            String randomRenk = renk[random.nextInt(renk.length)];
            int randomSayi = sayi[random.nextInt(sayi.length)];
            String[] PlayerDeck = {randomRenk + " " + randomSayi};
            System.out.println("Player's Deck: " + randomRenk + " " + randomSayi);

            randomRenk = renk[random.nextInt(renk.length)];
            randomSayi = sayi[random.nextInt(sayi.length)];
            String[] CompDeck = {randomRenk + " " + randomSayi};
            System.out.println("Comp's Deck: " + randomRenk + " " + randomSayi);



            System.out.println("Player's Hand: ");
            PrintHand(PlayerHand);
            //System.out.println("Comp's Hand: ");
            //PrintHand(CompHand);

            int playerDeckTotal = calculateDeckTotal(PlayerDeck);
            int compDeckTotal = calculateDeckTotal(CompDeck);

            boolean playerBlueCards = checkBlueCards(PlayerDeck);
            boolean compBlueCards = checkBlueCards(CompDeck);

            if (playerBlueCards) {
                System.out.println("Player's Deck Total (Blue): " + playerDeckTotal);
            } else {
                System.out.println("Player's Deck Total: " + playerDeckTotal);
            }

            if (compBlueCards) {
                System.out.println("Comp's Deck Total (Blue): " + compDeckTotal);
            } else {
                System.out.println("Comp's Deck Total: " + compDeckTotal);
            }

            while (true) {
                System.out.println("Stand, Play a Card or End?: ");
                String m = sc.next();
                if (m.equalsIgnoreCase("end")) {
                    randomRenk = renk[random.nextInt(renk.length)];
                    randomSayi = sayi[random.nextInt(sayi.length)];
                    String playerRandomNew = randomRenk + " " + randomSayi;
                    System.out.println("Player Draw: " + playerRandomNew);
                    String[] newPlayerDeck = new String[PlayerDeck.length + 1];
                    System.arraycopy(PlayerDeck, 0, newPlayerDeck, 0, PlayerDeck.length);
                    newPlayerDeck[PlayerDeck.length] = playerRandomNew;
                    PlayerDeck = newPlayerDeck;
                    playerDeckTotal = calculateDeckTotal(PlayerDeck);
                    System.out.println("Player's Deck Total: " + playerDeckTotal);

                    randomRenk = renk[random.nextInt(renk.length)];
                    randomSayi = sayi[random.nextInt(sayi.length)];
                    String compRandomNew = randomRenk + " " + randomSayi;
                    System.out.println("Comp Draw: " + compRandomNew);
                    String[] newCompDeck = new String[CompDeck.length + 1];
                    System.arraycopy(CompDeck, 0, newCompDeck, 0, CompDeck.length);
                    newCompDeck[CompDeck.length] = compRandomNew;
                    CompDeck = newCompDeck;
                    compDeckTotal = calculateDeckTotal(CompDeck);
                    System.out.println("Comp's Deck Total: " + compDeckTotal);



                    if(compDeckTotal > 20 && playerDeckTotal > 20) {
                        System.out.println("So who won? Friendship.");
                        System.out.println("Ready for another round? (yes/no): ");
                        String l = sc.next();
                        if (l.equalsIgnoreCase("yes")) {
                            break;
                        }
                        break;
                    } else if (playerDeckTotal > 20) {
                        System.out.println("Bust! Easy there tiger, you passed 20.");
                        System.out.println("Ready for another round? (yes/no): ");
                        String l = sc.next();
                        if (l.equalsIgnoreCase("yes")) {
                            break;
                        }
                        break;
                    } else if(compDeckTotal > 20 ) {
                        System.out.println("Comp busted! You got lucky.");
                        System.out.println("Ready for another round? (yes/no): ");
                        String l = sc.next();
                        if (l.equalsIgnoreCase("yes")) {
                            break;
                        }
                        break;
                    }

                } else if (m.equalsIgnoreCase("stand")) {
                    if(playerDeckTotal == 20 && compDeckTotal != 20){
                    System.out.println("You win!");
                    break;
                    } else if (20 > compDeckTotal && compDeckTotal > playerDeckTotal){
                        System.out.println("You lose!");
                        break;
                    }else if (20 > playerDeckTotal && playerDeckTotal > compDeckTotal){
                        System.out.println("You win!");
                        break;
                    }else if (20 == playerDeckTotal && 20 == compDeckTotal) {
                        System.out.println("So who won? Friendship.");
                        break;
                    }else if(compDeckTotal == playerDeckTotal){
                        System.out.println("So who won? Friendship.");
                        break;
                    } else{
                        System.out.println("You lose!");
                        break;
                    }
                }else if (m.equalsIgnoreCase("play a card")){
                   
                   
                    break;
                }
            }
            playerBlueCards = checkBlueCards(PlayerDeck);
            compBlueCards = checkBlueCards(CompDeck);


        }
    }
    private static boolean checkBlueCards(String[] deck) {
        for (String card : deck) {
            if (card.startsWith("Blue")) {
                return true;
            }
        }
        return false;
    }

    private static int calculateDeckTotal(String[] deck) {
        int total = 0;
        for (String card : deck) {
            total += getValue(card);
        }
        return total;
    }

    private static int getValue(String card) {
        String[] parts = card.split(" ");
        if (parts.length == 2) {
            return Integer.parseInt(parts[1]);
        } else {
            return 0;
        }
    }
}
